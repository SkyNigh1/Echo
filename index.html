<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot BotLibre</title>
    <script type="text/javascript" src="https://www.botlibre.com/scripts/sdk.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        #chat-box { border: 1px solid #ccc; padding: 10px; height: 300px; overflow-y: auto; margin-bottom: 10px; }
        #chat-box p { margin: 5px 0; }
        #chat-input { width: 80%; padding: 5px; }
        #send-btn { padding: 5px 10px; }
    </style>
</head>
<body>
    <h1>Chatbot Echo</h1>
    <div id="chat-box"></div>
    <input id="chat-input" type="text" placeholder="Tapez un message">
    <button id="send-btn">Envoyer</button>

    <script type="text/javascript">
        SDK.applicationId = "8983130909301834963"; // Application ID BotLibre
        var sdk = new SDKConnection();
        var web = new WebChatbotListener();
        web.connection = sdk;
        web.instance = "58927128"; // Bot ID num√©rique
        web.instanceName = "Echo";
        web.userName = "Utilisateur";
        web.speak = false;

        const chatBox = document.getElementById("chat-box");
        const chatInput = document.getElementById("chat-input");
        const sendBtn = document.getElementById("send-btn");

        // Fonction pour afficher un message dans le chat
        function addMessage(sender, message) {
            const p = document.createElement("p");
            p.textContent = sender + ": " + (message || "Le bot n'a pas compris.");
            chatBox.appendChild(p);
            chatBox.scrollTop = chatBox.scrollHeight; // scroll automatique
        }

        // Fonction pour envoyer le message au bot
        async function sendMessage() {
            const message = chatInput.value.trim();
            if (!message) return;
            addMessage("Vous", message);
            chatInput.value = "";

            try {
                const response = await fetch(`https://www.botlibre.com/rest/api/chat?application=${SDK.applicationId}&instance=${web.instance}&message=${encodeURIComponent(message)}`);
                const data = await response.json();
                addMessage(web.instanceName, data.message);
            } catch (error) {
                addMessage(web.instanceName, "Erreur de communication avec le bot.");
                console.error(error);
            }
        }

        sendBtn.addEventListener("click", sendMessage);
        chatInput.addEventListener("keydown", function(e) {
            if (e.key === "Enter") sendMessage();
        });

        // Message de bienvenue
        addMessage(web.instanceName, "Bonjour ! Tapez un message pour commencer la conversation.");
    </script>
</body>
</html>
